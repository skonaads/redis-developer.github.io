<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redis Developer Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redis Developer Blog Atom Feed"><title data-react-helmet="true">Online Database Migration from Amazon ElastiCache to Redis Enterprise Cloud using RIOT | Redis Developer</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Online Database Migration from Amazon ElastiCache to Redis Enterprise Cloud using RIOT | Redis Developer"><meta data-react-helmet="true" name="description" content="Authors: Ajeet Singh Raina, Julien Ruaux"><meta data-react-helmet="true" property="og:description" content="Authors: Ajeet Singh Raina, Julien Ruaux"><meta data-react-helmet="true" property="og:url" content="https://developer.redislabs.com/guides/import/database-migration-aws-elasticache-redis-enterprise-cloud"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://developer.redislabs.com/guides/import/database-migration-aws-elasticache-redis-enterprise-cloud"><link rel="stylesheet" href="/styles.7ace2829.css">
<link rel="preload" href="/styles.35e188c0.js" as="script">
<link rel="preload" href="/runtime~main.d7b0db6e.js" as="script">
<link rel="preload" href="/main.823e3f13.js" as="script">
<link rel="preload" href="/1.158b6b67.js" as="script">
<link rel="preload" href="/2.a3e54825.js" as="script">
<link rel="preload" href="/3.e84b6664.js" as="script">
<link rel="preload" href="/1be78505.af519408.js" as="script">
<link rel="preload" href="/935f2afb.8e228605.js" as="script">
<link rel="preload" href="/17896441.fa97ad9e.js" as="script">
<link rel="preload" href="/2b53ff98.450505c5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/logos/redis.svg" alt="Redis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logos/redis.svg" alt="Redis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Redis Developer</strong></a><a class="navbar__item navbar__link" href="/">Getting Started</a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logos/redis.svg" alt="Redis Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logos/redis.svg" alt="Redis Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Redis Developer</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Getting Started</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Online Database Migration from Amazon ElastiCache to Redis Enterprise Cloud using RIOT</h1></header><div class="markdown"><p>Authors: Ajeet Singh Raina, Julien Ruaux</p><p>Most of the database migration tools available today are offline in nature. They are complex and require manual intervention. </p><p>If you want to migrate your data from Amazon ElastiCache to Redis Enterprise Cloud, for example, the usual process is to back up your ElastiCache data to an Amazon S3 bucket and then import your data using the Redis Enterprise Cloud UI. This process can require painful downtime and could result in data loss. Other available techniques include creating point-in-time snapshots of the source Redis server and applying the changes to the destination servers to keep both the servers in sync. That might sound like a good approach, but it can be challenging when you have to maintain dozens of scripts to implement the migration strategy. </p><p>So we‚Äôve come up with a different approach:</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introducing-riot"></a>Introducing RIOT<a class="hash-link" href="#introducing-riot" title="Direct link to heading">#</a></h1><p><img alt="image" src="/assets/images/ajeet-riot-blog-1-c485eb485da7e268572402897924d564.png"></p><p>RIOT is an open source online migration tool built by Julien Ruaux, a Solution Architect at Redis Labs. RIOT implements client-side replication using a producer/consumer approach. The producer is the combination of the key and value readers that have a connection to ElastiCache. The key reader component identifies keys to be replicated using scan and keyspace notifications. For each key, the value reader component performs a DUMP and handles the resulting key+bytes to the consumer (writer), which performs a RESTORE on the Redis Enterprise connection.</p><p>This blog post will show how to perform a seamless online migration of databases from ElastiCache to Redis Enterprise Cloud.</p><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prerequisites"></a>Prerequisites:<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h1><p>You will require a few resources to use the migration tool:</p><ul><li>A Redis Enterprise Cloud subscription</li><li>Amazon ElastiCache (a primary endpoint in case of a single-master EC and a configuration endpoint in case of a clustered EC: Refer to Finding Connection Endpoints on the ElastiCache documentation to learn more)</li><li>An Amazon EC2 instance based on Linux</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="step-1---setting-up-an-amazon-ec2-instance"></a>Step 1 - Setting up an Amazon EC2 instance<a class="hash-link" href="#step-1---setting-up-an-amazon-ec2-instance" title="Direct link to heading">#</a></h2><p>You can either create a new EC2 instance or leverage an existing one. In our example, we will first create an instance on Amazon Web Services (AWS). The most common scenario is to access an ElastiCache cluster from an Amazon EC2 instance in the same Amazon Virtual Private Cloud (Amazon VPC). We have used Ubuntu 16.04 LTS for this setup, but you can choose the Ubuntu or Debian distribution of your choice.</p><p>Use SSH to connect to this new EC2 instance from your computer as shown here:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ssh -i ‚Äúpublic key‚Äù &lt;AWS EC2 Instance&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="step-2---install-the-redis-cli-tool"></a>Step 2 - Install the redis-cli tool<a class="hash-link" href="#step-2---install-the-redis-cli-tool" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo apt update</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># sudo apt install -y redis-tools</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="verify-the-connectivity-with-the-elasticache-database"></a>Verify the connectivity with the ElastiCache database<a class="hash-link" href="#verify-the-connectivity-with-the-elasticache-database" title="Direct link to heading">#</a></h3><p>Syntax:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ redis-cli -h &lt;Elasticache Primary Endpoint &gt; -p 6379</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo redis-cli -h &lt;elasticache primary endpoint&gt; -p 6379</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Ensure that the above command allows you to connect to the remote Redis database successfully. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="step-3---using-the-riot-migration-tool"></a>Step 3 - Using the RIOT migration tool<a class="hash-link" href="#step-3---using-the-riot-migration-tool" title="Direct link to heading">#</a></h2><p>Run the commands below to set up the migration tool. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="prerequisites-1"></a>Prerequisites:<a class="hash-link" href="#prerequisites-1" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="install-java"></a>Install Java<a class="hash-link" href="#install-java" title="Direct link to heading">#</a></h4><p>We recommended using OpenJDK 11 or later:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo add-apt-repository ppa:openjdk-r/ppa &amp;&amp; sudo apt-get update -q &amp;&amp; sudo apt install -y openjdk-11-jdk</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="installing-riot"></a>Installing RIOT<a class="hash-link" href="#installing-riot" title="Direct link to heading">#</a></h4><p>Unzip the package and make sure the RIOT binaries are in place, as shown here:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">wget https://github.com/Redislabs-Solution-Architects/riot/releases/download/v2.0.8/riot-redis-2.0.8.zip</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">unzip riot-redis-2.0.8.zip</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cd riot-redis-2.0.8/bin/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can check the version of RIOT by running the command below:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">./riot-redis --version</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RIOT version &quot;2.0.8&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">bin/riot-redis --help</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Usage: riot-redis [OPTIONS] [COMMAND]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -q, --quiet         Log errors only</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -d, --debug         Log in debug mode (includes normal stacktrace)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -i, --info          Set log level to info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -h, --help          Show this help message and exit.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -V, --version       Print version information and exit.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Redis connection options</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -r, --redis=&lt;uri&gt;   Redis connection string (default: redis://localhost:6379)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -c, --cluster       Connect to a Redis Cluster</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -m, --metrics       Show metrics</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  -p, --pool=&lt;int&gt;    Max pool connections (default: 8)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Commands:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  replicate, r  Replicate a source Redis database in a target Redis database</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  info, i       Display INFO command output</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  latency, l    Calculate latency stats</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ping, p       Execute PING command</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Once Java and RIOT are installed, we are all set to begin the migration process with the command below, which replicates data directly from the source (ElastiCache) to the target (Redis Enterprise Cloud).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="step-4---migrate-the-data"></a>Step 4 - Migrate the data<a class="hash-link" href="#step-4---migrate-the-data" title="Direct link to heading">#</a></h2><p>Finally, it‚Äôs time to replicate the data from ElastiCache to Redis Enterprise Cloud by running the below command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">sudo ./riot-redis -r redis://&lt;source Elasticache endpoint&gt;:6379 replicate -r redis://password@&lt;Redis Enterprise Cloud endpoint&gt;:port --live</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ElastiCache allows you to configure in two ways: clustered and non-clustered. In the chart below, the first row shows what commands you should perform for the non-clustered scenario, while the second row shows the command for the clustered scenario with a specific database namespace:</p><p>As you can see, whenever you have a clustered ElastiCache, you need to pass the ‚Äìcluster option before specifying the source ElastiCache endpoint.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="important-notes"></a>Important notes<a class="hash-link" href="#important-notes" title="Direct link to heading">#</a></h2><ul><li>Perform user acceptance testing of the migration before using it in production.</li><li>Once the migration is complete, ensure that application traffic gets successfully redirected to the Redis Enterprise endpoint.</li><li>Perform the migration process during a period of low traffic to minimize the chance of data loss.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>If you‚Äôre looking for a simple and easy-to-use live migration tool that can help you move data from Amazon ElastiCache to Redis Enterprise Cloud with no downtime, RIOT is a promising option.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/redis-developer/redis-developer/edit/master/docs/guides/import/database-migration-aws-elasticache-redis-enterprise-cloud.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#step-1---setting-up-an-amazon-ec2-instance" class="table-of-contents__link">Step 1 - Setting up an Amazon EC2 instance</a></li><li><a href="#step-2---install-the-redis-cli-tool" class="table-of-contents__link">Step 2 - Install the redis-cli tool</a><ul><li><a href="#verify-the-connectivity-with-the-elasticache-database" class="table-of-contents__link">Verify the connectivity with the ElastiCache database</a></li></ul></li><li><a href="#step-3---using-the-riot-migration-tool" class="table-of-contents__link">Step 3 - Using the RIOT migration tool</a><ul><li><a href="#prerequisites-1" class="table-of-contents__link">Prerequisites:</a></li></ul></li><li><a href="#step-4---migrate-the-data" class="table-of-contents__link">Step 4 - Migrate the data</a></li><li><a href="#important-notes" class="table-of-contents__link">Important notes</a></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Develop</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/develop/java">Java</a></li><li class="footer__item"><a class="footer__link-item" href="/develop/python">Python</a></li><li class="footer__item"><a class="footer__link-item" href="/develop/node">Node.js</a></li><li class="footer__item"><a class="footer__link-item" href="/develop/golang">Go</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/redis" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://forum.redislabs.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discussion Forums</a></li><li class="footer__item"><a href="https://twitter.com/redislabs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://redislabs.com/blog/tech-blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/redis-developer/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 RedisLabs Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.35e188c0.js"></script>
<script src="/runtime~main.d7b0db6e.js"></script>
<script src="/main.823e3f13.js"></script>
<script src="/1.158b6b67.js"></script>
<script src="/2.a3e54825.js"></script>
<script src="/3.e84b6664.js"></script>
<script src="/1be78505.af519408.js"></script>
<script src="/935f2afb.8e228605.js"></script>
<script src="/17896441.fa97ad9e.js"></script>
<script src="/2b53ff98.450505c5.js"></script>
</body>
</html>